!function (l, d) {
    l.HTMLInclude || (l.HTMLInclude = function () {
        function r(t, e) {
            return t.getBoundingClientRect().top <= +e + l.innerHeight;
        }
        function a(t, e) {
            var o = new XMLHttpRequest();
            o.onreadystatechange = function () {
                if (4 == o.readyState && 200 == o.status) {
                    e.forEach(function (t) {
                        var e = t.getAttribute("data-replace");
                        var n = o.responseText;
                        e && e.split(",").forEach(function (t) {
                            var e = t.trim().split(":");
                            n = n.replace(new RegExp(e[0], "g"), e[1]);
                        });
                        t.outerHTML = n;

                        // Execute scripts in the loaded content
                        var scripts = (new DOMParser).parseFromString(n, "text/html").querySelectorAll("SCRIPT");
                        for (var i = 0; i < scripts.length; i++) {
                            var script = d.createElement("SCRIPT");
                            if (scripts[i].src) {
                                script.src = scripts[i].src;
                            } else {
                                script.innerHTML = scripts[i].innerHTML;
                            }
                            d.head.appendChild(script);
                        }
                    });
                }
            };
            o.open("GET", t, !0);
            o.send();
        }
        function t(e, n) {
            l.addEventListener("scroll", function t() {
                if (r(e, n)) {
                    l.removeEventListener("scroll", t);
                    a(e.getAttribute("data-include"), [e]);
                }
            });
        }
        var e = {};
        var n = d.querySelectorAll("[data-include]:not([data-in])");
        for (var i = n.length; i--; ) {
            var c = n[i].getAttribute("data-include");
            var o = n[i].getAttribute("data-lazy");
            n[i].setAttribute("data-in", "");
            if (!o || (o && r(n[i], o))) {
                e[c] = e[c] || [];
                e[c].push(n[i]);
            } else {
                t(n[i], o);
            }
        }
        for (var u in e) {
            a(u, e[u]);
        }
    });

    l.HTMLInclude();
}(window, document);
